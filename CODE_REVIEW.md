# üìã –ö–æ–¥-—Ä–µ–≤—å—é –ø—Ä–æ–µ–∫—Ç–∞ Zenoh Robot Explorer

> **–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 22 –æ–∫—Ç—è–±—Ä—è 2025
> **–†–µ–≤—å—é–µ—Ä:** AI Code Review
> **–í–µ—Ä—Å–∏—è:** 1.0.0

## üìä –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ (4/5)

–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç —Ö–æ—Ä–æ—à—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –Ω–æ –µ—Å—Ç—å –æ–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≤ –ø–ª–∞–Ω–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞, —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫.

---

## ‚úÖ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã

### 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è
- ‚ú® –•–æ—Ä–æ—à–µ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏ (`main.ts`, `map.ts`, `idl.ts`)
- ‚ú® –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π (TypeScript, Vite, CDR)
- ‚ú® –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å EventSource –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 2. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚ú® –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Zenoh REST API
- ‚ú® –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π ROS
- ‚ú® –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω—ã—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π (map ‚Üî odom)
- ‚ú® –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ Canvas

### 3. UX
- ‚ú® –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚ú® –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≥–µ–π–º–ø–∞–¥–∞
- ‚ú® –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ localStorage

---

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

### 1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏**

**–ü—Ä–æ–±–ª–µ–º–∞:** EventSource —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –º–æ–≥—É—Ç –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∏–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Ä–æ–±–æ—Ç–æ–≤.

**–õ–æ–∫–∞—Ü–∏—è:** `main.ts`, —Ñ—É–Ω–∫—Ü–∏–∏ `startXxxFeed()`

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –î–æ–±–∞–≤–∏—Ç—å —Ç–∞–π–º–∞—É—Ç—ã –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
let reconnectTimer: NodeJS.Timeout | null = null;

function startCameraFeed(robotName: string) {
  // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ç–∞–π–º–µ—Ä–æ–≤
  if (reconnectTimer) {
    clearTimeout(reconnectTimer);
    reconnectTimer = null;
  }

  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...

  cameraEventSource.addEventListener("error", (err) => {
    console.error("[SSE Camera] –û—à–∏–±–∫–∞:", err);
    
    // –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
    reconnectTimer = setTimeout(() => {
      if (robotSelect.value === robotName) {
        startCameraFeed(robotName);
      }
    }, 5000);
  });
}
```

### 2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º.

**–õ–æ–∫–∞—Ü–∏—è:** –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ `handleXxxEvent()`

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
function handleMapEvent(event: MessageEvent) {
  try {
    const sample = JSON.parse(event.data) as { value: string };
    if (!sample.value) return;

    const bytes = base64ToBytes(sample.value);
    const parsed = parseCDRBytes(bytes, occupancyGridSchema, {
      maxSequenceSize: 1_000_000,
    });

    const mapMsg = parsed.payload;
    
    // ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é
    if (!isValidOccupancyGrid(mapMsg)) {
      console.error('[Map] –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã', mapMsg);
      return;
    }

    currentMap = mapMsg;
    renderMap(mapMsg);
  } catch (err) {
    console.error("[SSE Map] –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–¥–µ–Ω–∏—è:", err);
  }
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
function isValidOccupancyGrid(msg: any): msg is OccupancyGrid {
  return (
    msg &&
    typeof msg.info?.width === 'number' &&
    typeof msg.info?.height === 'number' &&
    Array.isArray(msg.data) &&
    msg.data.length === msg.info.width * msg.info.height
  );
}
```

### 3. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–≤—Ç–æ—Ä—è—é—â–∞—è—Å—è –ª–æ–≥–∏–∫–∞ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è base64 ‚Üí CDR –≤ –∫–∞–∂–¥–æ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ.

**–õ–æ–∫–∞—Ü–∏—è:** –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ `handleXxxEvent()`

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
function parseZenohMessage<T>(
  eventData: string,
  schema: any,
  maxSequenceSize: number = 10_000
): T | null {
  try {
    const sample = JSON.parse(eventData) as { value: string };
    if (!sample.value) return null;

    const bytes = base64ToBytes(sample.value);
    const parsed = parseCDRBytes(bytes, schema, { maxSequenceSize });
    return parsed.payload as T;
  } catch (err) {
    console.error('[Parse] –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞:', err);
    return null;
  }
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è base64
function base64ToBytes(base64: string): Uint8Array {
  const binaryString = atob(base64);
  const bytes = new Uint8Array(binaryString.length);
  for (let i = 0; i < binaryString.length; i++) {
    bytes[i] = binaryString.charCodeAt(i);
  }
  return bytes;
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
function handleMapEvent(event: MessageEvent) {
  const mapMsg = parseZenohMessage<OccupancyGrid>(
    event.data,
    occupancyGridSchema,
    1_000_000
  );
  
  if (!mapMsg || !isValidOccupancyGrid(mapMsg)) return;
  
  currentMap = mapMsg;
  renderMap(mapMsg);
}
```

---

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

### 4. **–£–ª—É—á—à–µ–Ω–∏–µ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `any` —Ç–∏–ø–æ–≤, –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º.

**–õ–æ–∫–∞—Ü–∏—è:** –ü–æ–≤—Å–µ–º–µ—Å—Ç–Ω–æ –≤ `main.ts`

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª types.ts
export interface LaserScan {
  header: Header;
  angle_min: number;
  angle_max: number;
  angle_increment: number;
  time_increment: number;
  scan_time: number;
  range_min: number;
  range_max: number;
  ranges: number[];
  intensities: number[];
}

export interface Header {
  stamp: Time;
  frame_id: string;
}

export interface Time {
  sec: number;
  nanosec: number;
}

export interface Image {
  header: Header;
  height: number;
  width: number;
  encoding: string;
  is_bigendian: number;
  step: number;
  data: number[];
}

// –ò —Ç.–¥. –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤
```

### 5. **–í—ã–Ω–µ—Å—Ç–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª**

**–ü—Ä–æ–±–ª–µ–º–∞:** –•–∞—Ä–¥–∫–æ–¥ URL –∏ –¥—Ä—É–≥–∏—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç –≤ –∫–æ–¥–µ.

**–õ–æ–∫–∞—Ü–∏—è:** `main.ts`

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –°–æ–∑–¥–∞—Ç—å config.ts
export const CONFIG = {
  ZENOH_REST_BASE: import.meta.env.VITE_ZENOH_URL || 'https://zenoh.robbox.online',
  RECONNECT_DELAY: 5000,
  MAX_RECONNECT_ATTEMPTS: 5,
  MAX_SEQUENCE_SIZES: {
    IMAGE: 300_000,
    MAP: 1_000_000,
    LIDAR: 10_000,
    DEFAULT: 10_000,
  },
  CANVAS: {
    MAP_SIZE: 600,
    LIDAR_SIZE: 600,
  },
} as const;

// –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª
VITE_ZENOH_URL=https://zenoh.robbox.online
```

### 6. **–†–∞–∑–¥–µ–ª–∏—Ç—å main.ts –Ω–∞ –º–æ–¥—É–ª–∏**

**–ü—Ä–æ–±–ª–µ–º–∞:** –§–∞–π–ª `main.ts` —Å–æ–¥–µ—Ä–∂–∏—Ç 2000+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞.

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
src/
‚îú‚îÄ‚îÄ main.ts              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ config.ts            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îú‚îÄ‚îÄ ros-messages.ts  # –¢–∏–ø—ã ROS —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ schemas.ts       # CDR —Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ zenoh-client.ts  # –†–∞–±–æ—Ç–∞ —Å Zenoh API
‚îÇ   ‚îî‚îÄ‚îÄ sse-manager.ts   # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ EventSource
‚îú‚îÄ‚îÄ renderers/
‚îÇ   ‚îú‚îÄ‚îÄ camera.ts        # –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–∞–º–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ map.ts           # –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–∞—Ä—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ lidar.ts         # –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –ª–∏–¥–∞—Ä–∞
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ cdr-parser.ts    # –£—Ç–∏–ª–∏—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞
‚îÇ   ‚îî‚îÄ‚îÄ transforms.ts    # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ ui/
    ‚îú‚îÄ‚îÄ controls.ts      # UI –∫–æ–Ω—Ç—Ä–æ–ª—ã
    ‚îî‚îÄ‚îÄ gamepad.ts       # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–µ–π–º–ø–∞–¥–æ–º
```

### 7. **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–º–µ—à–∞–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `console.log`, `console.error`, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —É—Ä–æ–≤–Ω–µ–π –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// logger.ts
enum LogLevel {
  DEBUG = 0,
  INFO = 1,
  WARN = 2,
  ERROR = 3,
}

class Logger {
  private level: LogLevel = LogLevel.INFO;

  setLevel(level: LogLevel) {
    this.level = level;
  }

  debug(message: string, ...args: any[]) {
    if (this.level <= LogLevel.DEBUG) {
      console.debug(`[DEBUG] ${message}`, ...args);
    }
  }

  info(message: string, ...args: any[]) {
    if (this.level <= LogLevel.INFO) {
      console.info(`[INFO] ${message}`, ...args);
    }
  }

  warn(message: string, ...args: any[]) {
    if (this.level <= LogLevel.WARN) {
      console.warn(`[WARN] ${message}`, ...args);
    }
  }

  error(message: string, ...args: any[]) {
    if (this.level <= LogLevel.ERROR) {
      console.error(`[ERROR] ${message}`, ...args);
    }
  }
}

export const logger = new Logger();
```

### 8. **–î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
enum ConnectionState {
  DISCONNECTED = 'disconnected',
  CONNECTING = 'connecting',
  CONNECTED = 'connected',
  ERROR = 'error',
}

class ConnectionManager {
  private states = new Map<string, ConnectionState>();
  
  setState(source: string, state: ConnectionState) {
    this.states.set(source, state);
    this.updateUI();
  }
  
  private updateUI() {
    const allConnected = Array.from(this.states.values())
      .every(s => s === ConnectionState.CONNECTED);
    
    statusEl.className = allConnected ? 'status-connected' : 'status-error';
    // ...
  }
}
```

---

## üí° –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

### 9. **–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã**

```typescript
// tests/cdr-parser.test.ts
import { describe, it, expect } from 'vitest';
import { parseZenohMessage } from '../src/utils/cdr-parser';

describe('CDR Parser', () => {
  it('should parse valid base64 message', () => {
    const data = '...'; // mock data
    const result = parseZenohMessage(data, occupancyGridSchema);
    expect(result).toBeDefined();
  });

  it('should return null for invalid data', () => {
    const result = parseZenohMessage('invalid', occupancyGridSchema);
    expect(result).toBeNull();
  });
});
```

### 10. **–î–æ–±–∞–≤–∏—Ç—å CI/CD**

```yaml
# .github/workflows/ci.yml
name: CI

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
      - run: npm install
      - run: npm run build
      - run: npm test
```

### 11. **–î–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API**

```typescript
/**
 * –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ø–æ—Ç–æ–∫—É –∫–∞—Ä—Ç—ã —Ä–æ–±–æ—Ç–∞ —á–µ—Ä–µ–∑ Zenoh SSE
 * @param robotName - –ò–º—è —Ä–æ–±–æ—Ç–∞ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
 * @throws {Error} –ï—Å–ª–∏ EventSource –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º
 */
function startMapFeed(robotName: string): void {
  // ...
}
```

### 12. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `requestAnimationFrame` –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö
- –î–æ–±–∞–≤–∏—Ç—å throttling –¥–ª—è —á–∞—Å—Ç—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å OffscreenCanvas –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

```typescript
let animationFrameId: number | null = null;
let pendingRenderData: any = null;

function scheduleRender(data: any) {
  pendingRenderData = data;
  
  if (animationFrameId === null) {
    animationFrameId = requestAnimationFrame(() => {
      if (pendingRenderData) {
        renderMap(pendingRenderData);
        pendingRenderData = null;
      }
      animationFrameId = null;
    });
  }
}
```

---

## üì¶ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º

### –û–±–Ω–æ–≤–∏—Ç—å package.json

```json
{
  "name": "zenoh-camera-viewer",
  "version": "1.0.0",
  "description": "Web interface for remote robot control via Zenoh protocol",
  "author": "krikz",
  "license": "ISC",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview",
    "lint": "eslint src --ext ts,tsx",
    "format": "prettier --write \"src/**/*.{ts,tsx,css,html}\"",
    "test": "vitest"
  },
  "devDependencies": {
    "@types/node": "^20.0.0",
    "@typescript-eslint/eslint-plugin": "^6.0.0",
    "@typescript-eslint/parser": "^6.0.0",
    "eslint": "^8.0.0",
    "prettier": "^3.0.0",
    "typescript": "^5.0.0",
    "vitest": "^1.0.0"
  }
}
```

### –î–æ–±–∞–≤–∏—Ç—å ESLint –∏ Prettier

```javascript
// .eslintrc.cjs
module.exports = {
  parser: '@typescript-eslint/parser',
  extends: [
    'eslint:recommended',
    'plugin:@typescript-eslint/recommended',
  ],
  rules: {
    '@typescript-eslint/no-explicit-any': 'warn',
    '@typescript-eslint/no-unused-vars': 'error',
  },
};
```

```json
// .prettierrc
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 100,
  "tabWidth": 2
}
```

---

## üéØ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ (1-2 –Ω–µ–¥–µ–ª–∏)
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å `.gitignore`
2. ‚úÖ –£–ª—É—á—à–∏—Ç—å README.md
3. ‚¨ú –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (#1-3)
4. ‚¨ú –í—ã–Ω–µ—Å—Ç–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ –∫–æ–Ω—Ñ–∏–≥
5. ‚¨ú –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø—ã –¥–ª—è –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ (1 –º–µ—Å—è—Ü)
6. ‚¨ú –†–∞–∑–¥–µ–ª–∏—Ç—å main.ts –Ω–∞ –º–æ–¥—É–ª–∏
7. ‚¨ú –î–æ–±–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
8. ‚¨ú –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å ConnectionManager
9. ‚¨ú –ù–∞—Å—Ç—Ä–æ–∏—Ç—å ESLint –∏ Prettier

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ (2-3 –º–µ—Å—è—Ü–∞)
10. ‚¨ú –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã
11. ‚¨ú –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD
12. ‚¨ú –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
13. ‚¨ú –î–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é JSDoc

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–æ–¥–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|---------|----------|--------------|
| –†–∞–∑–º–µ—Ä main.ts | 2043 —Å—Ç—Ä–æ–∫–∏ | < 500 —Å—Ç—Ä–æ–∫ |
| –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `any` | ~30 —Ä–∞–∑ | < 5 —Ä–∞–∑ |
| –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ | 0% | > 70% |
| –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ | ~15% | < 5% |
| –¶–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å | –°—Ä–µ–¥–Ω—è—è | –ù–∏–∑–∫–∞—è |

---

## üéì –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ö–æ—Ä–æ—à–µ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å Zenoh –∏ ROS, –∏–º–µ–µ—Ç —Ä–∞–±–æ—á—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å–ª–æ–∂–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏. –û—Å–Ω–æ–≤–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç—Å—è –≤ –æ–±–ª–∞—Å—Ç–∏:

1. **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –º–æ–¥—É–ª–∏
2. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç–∏** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
3. **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç–∏** - —Ç–∏–ø–∏–∑–∞—Ü–∏—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤ –¥–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è.

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –≤—Ä–µ–º—è –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 2-3 –Ω–µ–¥–µ–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 22 –æ–∫—Ç—è–±—Ä—è 2025*
*–í–µ—Ä—Å–∏—è: 1.0*
